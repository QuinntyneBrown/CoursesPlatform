<mxfile host="app.diagrams.net" modified="2025-12-25T00:00:00.000Z" agent="Claude" version="22.1.0" type="device">
  <diagram name="Content Moderation C4 Container Diagram" id="c4-content-moderation">
    <mxGraphModel dx="1434" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="Content Moderation - C4 Container Diagram" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=24;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="500" y="20" width="600" height="40" as="geometry" />
        </mxCell>

        <!-- External Users -->
        <mxCell id="user" value="&lt;b&gt;User&lt;/b&gt;&lt;br&gt;[Person]&lt;br&gt;&lt;br&gt;Platform user who can flag inappropriate content and submit appeals" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#08427B;strokeColor=none;fontColor=#FFFFFF;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="100" y="120" width="180" height="120" as="geometry" />
        </mxCell>

        <mxCell id="moderator" value="&lt;b&gt;Moderator&lt;/b&gt;&lt;br&gt;[Person]&lt;br&gt;&lt;br&gt;Reviews flagged content and takes moderation actions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#08427B;strokeColor=none;fontColor=#FFFFFF;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="320" y="120" width="180" height="120" as="geometry" />
        </mxCell>

        <mxCell id="admin" value="&lt;b&gt;Administrator&lt;/b&gt;&lt;br&gt;[Person]&lt;br&gt;&lt;br&gt;Reviews appeals and manages moderation settings" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#08427B;strokeColor=none;fontColor=#FFFFFF;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="540" y="120" width="180" height="120" as="geometry" />
        </mxCell>

        <!-- Angular Web Application -->
        <mxCell id="webapp" value="&lt;b&gt;Web Application&lt;/b&gt;&lt;br&gt;[Container: Angular]&lt;br&gt;&lt;br&gt;Provides moderation UI including flag content dialogs, moderation queue, review interface, appeals, and trust score displays" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#438DD5;strokeColor=none;fontColor=#FFFFFF;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="100" y="320" width="620" height="120" as="geometry" />
        </mxCell>

        <!-- API Container -->
        <mxCell id="api" value="&lt;b&gt;API Application&lt;/b&gt;&lt;br&gt;[Container: .NET 8 Web API]&lt;br&gt;&lt;br&gt;Provides REST endpoints for content moderation operations. Implements CQRS with MediatR for commands and queries" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#438DD5;strokeColor=none;fontColor=#FFFFFF;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="100" y="520" width="620" height="120" as="geometry" />
        </mxCell>

        <!-- Core Domain -->
        <mxCell id="core" value="&lt;b&gt;Core Domain Layer&lt;/b&gt;&lt;br&gt;[Container: .NET Class Library]&lt;br&gt;&lt;br&gt;Contains ContentFlag aggregate, ModerationAction entity, TrustScore value object, Appeal entity, and domain services" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#85BBF0;strokeColor=none;fontColor=#000000;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="100" y="720" width="280" height="140" as="geometry" />
        </mxCell>

        <!-- Infrastructure Layer -->
        <mxCell id="infra" value="&lt;b&gt;Infrastructure Layer&lt;/b&gt;&lt;br&gt;[Container: .NET Class Library]&lt;br&gt;&lt;br&gt;Implements ICoursesPlatformContext, Entity Framework configurations, and data persistence" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#85BBF0;strokeColor=none;fontColor=#000000;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="440" y="720" width="280" height="140" as="geometry" />
        </mxCell>

        <!-- Database -->
        <mxCell id="database" value="&lt;b&gt;Database&lt;/b&gt;&lt;br&gt;[Container: SQL Server]&lt;br&gt;&lt;br&gt;Stores content flags, moderation queue items, moderation actions, appeals, and trust scores" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#438DD5;strokeColor=none;fontColor=#FFFFFF;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="440" y="940" width="280" height="120" as="geometry" />
        </mxCell>

        <!-- AI Moderation Service -->
        <mxCell id="aiservice" value="&lt;b&gt;AI Moderation Service&lt;/b&gt;&lt;br&gt;[External System: Azure Content Safety API]&lt;br&gt;&lt;br&gt;Analyzes content for profanity, hate speech, adult content, and violence. Returns confidence scores and violation categories" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#999999;strokeColor=none;fontColor=#FFFFFF;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="860" y="520" width="280" height="140" as="geometry" />
        </mxCell>

        <!-- Notification Service -->
        <mxCell id="notification" value="&lt;b&gt;Notification Service&lt;/b&gt;&lt;br&gt;[Container: .NET Service]&lt;br&gt;&lt;br&gt;Sends notifications for moderation actions, warnings, bans, and appeal outcomes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#85BBF0;strokeColor=none;fontColor=#000000;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="860" y="720" width="280" height="120" as="geometry" />
        </mxCell>

        <!-- Email System -->
        <mxCell id="email" value="&lt;b&gt;Email System&lt;/b&gt;&lt;br&gt;[External System: SMTP/SendGrid]&lt;br&gt;&lt;br&gt;Delivers email notifications to users about moderation actions and appeals" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#999999;strokeColor=none;fontColor=#FFFFFF;fontSize=12;align=center;" vertex="1" parent="1">
          <mxGeometry x="860" y="940" width="280" height="100" as="geometry" />
        </mxCell>

        <!-- Relationships -->

        <!-- User to WebApp -->
        <mxCell id="edge1" value="Flags content, submits appeals&lt;br&gt;[HTTPS/JSON]" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.2;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;" edge="1" parent="1" source="user" target="webapp">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Moderator to WebApp -->
        <mxCell id="edge2" value="Reviews queue, takes actions&lt;br&gt;[HTTPS/JSON]" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;" edge="1" parent="1" source="moderator" target="webapp">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Admin to WebApp -->
        <mxCell id="edge3" value="Reviews appeals, manages settings&lt;br&gt;[HTTPS/JSON]" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.8;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;" edge="1" parent="1" source="admin" target="webapp">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- WebApp to API -->
        <mxCell id="edge4" value="Makes API calls to&lt;br&gt;[HTTPS/REST/JSON]" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;" edge="1" parent="1" source="webapp" target="api">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- API to Core -->
        <mxCell id="edge5" value="Uses domain models and services" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.25;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;dashed=1;" edge="1" parent="1" source="api" target="core">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- API to Infrastructure -->
        <mxCell id="edge6" value="Uses persistence context" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;dashed=1;" edge="1" parent="1" source="api" target="infra">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Infrastructure to Database -->
        <mxCell id="edge7" value="Reads from and writes to&lt;br&gt;[Entity Framework/SQL]" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;" edge="1" parent="1" source="infra" target="database">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- API to AI Service -->
        <mxCell id="edge8" value="Sends content for analysis&lt;br&gt;[HTTPS/REST]" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;" edge="1" parent="1" source="api" target="aiservice">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- API to Notification -->
        <mxCell id="edge9" value="Triggers notifications" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.25;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;dashed=1;" edge="1" parent="1" source="api" target="notification">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Notification to Email -->
        <mxCell id="edge10" value="Sends emails via&lt;br&gt;[SMTP]" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeWidth=2;fontSize=11;" edge="1" parent="1" source="notification" target="email">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#666666;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="1200" y="120" width="320" height="360" as="geometry" />
        </mxCell>

        <mxCell id="legend-title" value="&lt;b&gt;Legend&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1220" y="130" width="280" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend-person" value="&lt;b&gt;Person&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#08427B;strokeColor=none;fontColor=#FFFFFF;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="1220" y="170" width="120" height="40" as="geometry" />
        </mxCell>

        <mxCell id="legend-person-text" value="External user or system actor" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1350" y="175" width="150" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend-container" value="&lt;b&gt;Container&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#438DD5;strokeColor=none;fontColor=#FFFFFF;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="1220" y="220" width="120" height="40" as="geometry" />
        </mxCell>

        <mxCell id="legend-container-text" value="Application or service within the system" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1350" y="225" width="150" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend-support" value="&lt;b&gt;Support Container&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#85BBF0;strokeColor=none;fontColor=#000000;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="1220" y="270" width="120" height="40" as="geometry" />
        </mxCell>

        <mxCell id="legend-support-text" value="Supporting libraries and internal services" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1350" y="275" width="150" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend-external" value="&lt;b&gt;External System&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#999999;strokeColor=none;fontColor=#FFFFFF;fontSize=11;align=center;" vertex="1" parent="1">
          <mxGeometry x="1220" y="320" width="120" height="40" as="geometry" />
        </mxCell>

        <mxCell id="legend-external-text" value="External third-party systems" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1350" y="325" width="150" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend-relationship" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=11;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1220" y="385" as="sourcePoint" />
            <mxPoint x="1300" y="385" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="legend-relationship-text" value="Synchronous relationship" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1310" y="370" width="150" height="30" as="geometry" />
        </mxCell>

        <mxCell id="legend-dependency" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeWidth=2;fontSize=11;dashed=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1220" y="425" as="sourcePoint" />
            <mxPoint x="1300" y="425" as="targetPoint" />
          </mxGeometry>
        </mxCell>

        <mxCell id="legend-dependency-text" value="Dependency relationship" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1310" y="410" width="150" height="30" as="geometry" />
        </mxCell>

        <!-- Key API Endpoints Note -->
        <mxCell id="api-endpoints-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#FFF4E6;strokeColor=#E59400;strokeWidth=1;" vertex="1" parent="1">
          <mxGeometry x="1200" y="500" width="320" height="300" as="geometry" />
        </mxCell>

        <mxCell id="api-endpoints-title" value="&lt;b&gt;Key API Endpoints&lt;/b&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=13;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1220" y="510" width="280" height="25" as="geometry" />
        </mxCell>

        <mxCell id="api-endpoints-content" value="&lt;b&gt;Content Flagging:&lt;/b&gt;&lt;br&gt;• POST /api/moderation/flags&lt;br&gt;• GET /api/moderation/flags&lt;br&gt;&lt;br&gt;&lt;b&gt;Moderation Queue:&lt;/b&gt;&lt;br&gt;• GET /api/moderation/queue&lt;br&gt;• GET /api/moderation/queue/{id}&lt;br&gt;• POST /api/moderation/queue/{id}/claim&lt;br&gt;&lt;br&gt;&lt;b&gt;Moderation Actions:&lt;/b&gt;&lt;br&gt;• POST /api/moderation/actions&lt;br&gt;• GET /api/moderation/actions/history&lt;br&gt;&lt;br&gt;&lt;b&gt;Appeals:&lt;/b&gt;&lt;br&gt;• POST /api/moderation/appeals&lt;br&gt;• GET /api/moderation/appeals&lt;br&gt;• POST /api/moderation/appeals/{id}/review&lt;br&gt;&lt;br&gt;&lt;b&gt;Trust Scores:&lt;/b&gt;&lt;br&gt;• GET /api/moderation/users/{id}/trust-score" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1220" y="540" width="280" height="250" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
